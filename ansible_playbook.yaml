---
- name: My Playbok
  hosts: ansible_nodes
  remote_user: cloud_user
  become: true
  become_user: cloud_user
  tasks:
    - name: Adding google Cloud SDK as package source
      shell: echo "deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main" | sudo tee -a /etc/apt/sources.list.d/google-cloud-sdk.list
    - name: Install packages
      apt:
        name:
        - apt-transport-https
        - ca-certificates
        - gnupg
        state: latest
    - name: importing google cloud public key
      shell: curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key --keyring /usr/share/keyrings/cloud.google.gpg add -
    - name: Installing google-cloud-sdk
      apt:
        upgrad: yes
        update_cache: yes
        name:
        - google-cloud-sdk
        state: latest
